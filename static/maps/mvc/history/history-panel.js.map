{"version":3,"file":"history-panel.js","sources":["../../../src/mvc/history/history-panel.js"],"names":["define","LIST_PANEL","HISTORY_MODEL","HISTORY_CONTENTS","HDA_LI","HDCA_LI","COLLECTION_PANEL","USER","faIconButton","PopupMenu","BASE_MVC","_l","logNamespace","HistoryPrefs","SessionStorageModel","extend","defaults","expandedIds","show_deleted","show_hidden","addExpanded","model","key","this","save","_","get","object","id","removeExpanded","omit","toString","storageKeyPrefix","historyStorageKey","historyId","Error","clearAll","sessionStorage","indexOf","removeItem","_super","ModelListPanel","HistoryPanel","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","linkTarget","freeModel","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","loadHistoryWithDetails","historyFn","contentsFn","info","detailIdsFn","historyData","values","loadHistory","panel","History","getHistoryData","initiallyExpanded","_loadHistoryFromXHR","fail","where","history","always","then","historyJSON","contentsJSON","JSONToModel","render","refreshContents","detailIds","refresh","$","when","newHistoryJSON","newHdaJSON","log","setModel","_setUpWebStorage","storage","stopListening","isObject","set","isBoolean","listenTo","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","undefined","_buildNewRender","$newRender","$where","$el","multiselectActions","hideSelectors","find","remove","$existing","size","title","classes","faIcon","prependTo","_getItemViewClass","contentType","TypeError","_filterItem","hidden","isDeletedOrPurged","_getItemViewOptions","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","getSelectedModels","collection","events","clone","click .show-selectors-btn","click .messages [class$=message]","toggleShowDeleted","show","store","renderItems","toggleShowHidden","_firstSearch","searchFor","inputSelector","contents","haveDetails","searchItems","searchInput","fetchAllDetails","silent","done","status","readyState","parsed","_parseErrorMessage","$messages","is","displayMessage","message","once","user","Galaxy","currUser","_bePolite","raven","window","Raven","isFunction","lastEventId","agent","navigator","userAgent","url","lastAjax","data","source","toJSON","User","getAllResponseHeaders","responseHeaders","compact","split","map","header","type","scrollToTop","$msgContainer","$msg","addClass","html","isEmpty","$detailsLink","click","modal","_messageToModalOptions","append","functions","text","JSON","stringify","pre","body","buttons","Ok","hide","clearMessages","ev","$target","isUndefined","children","currentTarget","fadeOut","fxSpeed","scrollToHid","hid","scrollToItem","first","viewsWhereModel","templates","controlsTemplate","wrapTemplate","controls"],"mappings":"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"}